\documentclass[fontset=ubuntu,zihao=-4]{ctexart}
\usepackage{xeCJKfntef}

% \usepackage{imakeidx}
% \indexsetup{level=\section*, toclevel=section}
% \makeindex[title=索引, columns=2, intoc, columnseprule=true]

\usepackage{amsmath}
\usepackage[math-style=ISO, bold-style=ISO]{unicode-math} %注意，unicode-math与被其认为过时的bm包不兼容，不要\RequirePackage{bm}
\setmathfont[Scale = 1.1]{TeX Gyre Pagella Math}  % 因Libertinus目前的数学字体暂还没
% 有粗体，这里设置为允许伪粗体渲染。

\setmainfont[Scale=1.1]{Libertinus Serif}
\setsansfont[Scale=1.1]{TeX Gyre Heros}
\setmonofont{Noto Sans Mono Condensed}

\newcommand\doulos[1]{{\fontspec{Doulos SIL} /#1/}}

\usepackage{microtype} % 改善单词、字母间距

\usepackage[bodytextleadingratio = 1.68, restoremathleading = true,
footnoteleadingratio = 1.6]{zhlineskip}

\usepackage{verse}

% from package hyperref
\usepackage{hyperref}
\hypersetup{%
  colorlinks = true,
  citecolor=magenta,
  linkcolor=blue,
  bookmarks=true,
  bookmarksnumbered = true,
  bookmarksdepth = section,
  bookmarksopen = true,
  pdftitle = {老人与海 词汇注解},
  pdfauthor = {蛋疼的蛋蛋},
  pdfcreator = {sd44sd44@yeah.net},
}


\usepackage{geometry}

\geometry{%
  a4paper,
  heightrounded,
  includemp = false, % includes the margin notes, \marginparwidth and \marginparsep, into body when calculating horizontal calculation.
  inner = 2.5cm,
  outer = 2.2cm,
  % marginparwidth = 80pt,
  top = 2.5cm,
  bottom = 2.5cm,
  headheight = 6mm,
  headsep = 10mm,
  footskip = 10mm,
}

\usepackage{graphicx}
\usepackage{soul}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{tabularray}
\usepackage{unicode-math}
\usepackage{amsmath}
\usepackage{ulem}
\usepackage{emptypage}
\usepackage{geometry}
\usepackage{xcolor}

\UseTblrLibrary{booktabs}
\UseTblrLibrary{nameref}

\RequirePackage{emptypage} %空白页没有页眉页脚


\usepackage[record=nameref,stylemods=mcols, style=treegroup]{glossaries-extra}
% 重新定义 \seename
\renewcommand*{\seename}{见}

\GlsXtrLoadResources[
src={oldman},
selection=all,
sort={en-GB},
sort-field={name}
]
\renewcommand{\glossarypreamble}{\small}
% \renewcommand{\glstextformat}[1]{\textcolor{violet}{#1}}
\renewcommand{\glstextformat}[1]{\textbf{#1}}
% \renewcommand{\glsxtrregularfont}[1]{\underline{#1}}
% \renewcommand{\glsxtrabbreviationfont}[1]{\textbf{#1}}

% Define "ed" key:
\glsaddkey* {ed}% key
{\glsentrytext{\glslabel}ed}% default value
{\glsentryed}% command analogous to \glsentrytext
{\Glsentryed}% command analogous to \Glsentrytext
{\glsed}% command analogous to \glstext
{\Glsed}% command analogous to \Glstext
{\GLSed}% command analogous to \GLStext

% Define "ing" key:
\glsaddkey* {ing}% key
{\glsentrytext{\glslabel}ing}% default value
{\glsentrying}% command analogous to \glsentrytext
{\Glsentrying}% command analogous to \Glsentrytext
{\glsing}% command analogous to \glstext
{\Glsing}% command analogous to \Glstext
{\GLSing}% command analogous to \GLStext

\usepackage{paracol}
\footnoteplacement{p}

\setcolumnwidth{0.54\textwidth,0.44\textwidth}
% \setlength{\columnseprule}{0.4pt}
\setlength{\columnsep}{15pt}

% 自定义图片环境，包含纵向两个图片。注意这一自定义命令限制较多，需调整参数，
% 防止溢出。使用方法为
% \dingphotoh{photo1name}{photo1cap}{photo1description}{photo2name}{photo2cap}{photo2description}
\newcommand{\dingphotoh}[6] {
  \begin{figure}[htbp!]
    \centering
    \includegraphics[width=0.73\textwidth]{fish/#1}
    \caption{#2}\label{fig:#1}
    \raggedright\small #3
    \vfill \vspace{1cm}
    \centering
    \includegraphics[width=0.73\textwidth]{fish/#4}
    \caption{#5}\label{fig:#4}
    \raggedright\small #6
  \end{figure}
  \clearpage
}


\newlength{\drop}% for my convenience

\makeatletter
\def\subtitle#1{\gdef\@subtitle{#1}}
\def\@subtitle{\@latex@warning{No \noexpand\subtitle given}}

% \def\authornick#1{\gdef\@authornick{#1}}
% \def\@authornick{\@latex@warning{No \noexpand\authornick given}}

% \def\authorurl#1{\gdef\@authorurl{\url{#1}}}
% \def\@authorurl{\@latex@warning{No \noexpand\authorurl given}}


\def\maketitle{%
  \thispagestyle{empty}
  \null
  \begingroup
  \drop = 0.2\textheight
  \centering
  \vspace*{0.6\drop}
  {\Huge \bfseries \@title}\\[2\baselineskip]
  {\huge \bfseries \itshape \@subtitle}\\[3\baselineskip]

  \vspace*{0.8\drop}
  {
    \centering
    \Large
    \begin{tblr}{colspec={cc}}
      编\qquad 者： &  \@author \\
      日\qquad 期： & \@date \\
    \end{tblr}

  \vspace*{0.1\drop}
   \url{https://github.com/sd44/old-man-and-sea}

  \vspace*{0.5\drop}
  \kaishu{此书献给子墨、子韩和freemdict.com\\仅供学习交流}
  }
\vspace*{0.5\drop}

\endgroup
\vfill\null
\clearpage

\begingroup
\thispagestyle{empty}
\null
\newpage
\endgroup
}
\makeatother

\title{The Old Man and the Sea}
\subtitle{词汇注解}
\author{蛋疼的蛋蛋}
\date{2024年12月}

\begin{document}

\maketitle
\ctexset{section/numbering=false}

\newgeometry{inner=3cm,outer=2.8cm}

%% 目录
\tableofcontents

\clearpage

\input{preface.tex}

\clearpage

\section{《老人与海》相关图鉴}

\begin{figure}[ht!]
  \centering
  \includegraphics[width=0.85\textwidth]{fish/coast.png}
  \caption{\label{fig:coast}海滨各部分图例}
\end{figure}
\clearpage

\begin{figure}[ht!]
  \centering
  \includegraphics[width=0.85\textwidth]{fish/ship.jpg}
  \caption{\label{fig:ships}船只各部分图鉴}
\end{figure}
\clearpage

鱼类介绍有参考豆瓣cocojamboo文章

\url{https://book.douban.com/subject/1064275/discussion/616533832/}

\dingphotoh{marlin}{marlin, 枪鱼，马林鱼}{老人捕获的马林鱼身长十八尺
  （5.48米），体重一千五百磅（680公斤）}{tuna}{tuna, 金枪鱼}{活跃而敏捷的食肉
  动物，拥有光滑的流线型身体，也是游动速度最快的远洋鱼类之一。}

\dingphotoh{dolphin}{dolphin, 鲯鳅}{体较大且延长侧扁，前部高大，向后渐变细。
  头大，背部很窄，成鱼头背几呈方形，额部有一骨质隆起，随成长而越明显，尤以雄
  鱼为甚。}{flying}{flying fish, 飞鱼}{体态修长，稍稍侧扁，长度一般为45厘米。
  吻短，口小，眼大。胸鳍发达如翼，腹鳍也比较发达。借由尾部迅速摆动，可达到极大
  的速度，然后跃出水面，张开胸鳍，可滑行百米以上的距离。}


\dingphotoh{Makoshark}{Mako shark, 鲭鲨}{老人碰见和杀死的第一条鲨鱼。身体光滑
  细长，鼻端呈长锥形。它的胸鳍很短，尾鳍呈半月形。尾巴底部有明显的龙骨。牙齿
  幼长及轻微弯曲，当嘴巴紧合时仍可看见牙齿。雌鲨成年体长约2米，雄鲨成年体长
  约1.3米，最大体型约3.7米。 }{galanos}{galanos, 西班牙语中一种鲨鱼，可能
  是“直翅真鲨”}{细长、流线型身体，吻部宽而圆，前鼻瓣不明显，眼睛是圆形的，
  中等大小，双颚两侧各有14排牙齿，其最长可达3.0米（9.8英尺），体重可达85.5公
  斤，寿命可达24年。}

\dingphotoh{heming1}{1933年，欧内斯特·海明威、卡洛斯·古铁雷斯、乔·拉塞尔和
  乔·洛与马林鱼}{}{heming2}{1934年，欧内斯特·海明威和卡洛斯·古铁雷斯驾驶皮
  拉尔号}{}

\dingphotoh{heming3}{1935年7月，波林·海明威、欧内斯特·海明威和他的三个
  儿子，与四条蓝色马林鱼}{}{heming4}{古巴渔民成功捕获鲨鱼}{}

\begin{figure}[ht!]
  \centering
  \includegraphics[width=0.95\textwidth]{fish/heming5.jpg} \caption{\label{fig:heming5}1955年，古巴科伊马尔的渔民带回了一条马林鱼}
\end{figure}

\clearpage
\restoregeometry
\input{tmp.tex}


\printunsrtglossary[style={mcolindexgroup },title={Glossary 词汇表}]
% \printunsrtglossary[style={indexgroup}]
% \printunsrtglossary

\end{document}

%%% Local Variables:
%%% mode: LaTeX
%%% TeX-master: t
%%% End:
